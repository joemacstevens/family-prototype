const t="function"==typeof window.WeakMap&&"function"==typeof window.Map,e=function(){if(t)return window.WeakMap;function e(t,e){let i=-1;return t.some((t,s)=>{let r=t[0]===e;return r&&(i=s),r}),i}return class{constructor(){this.__entries__=[]}get(t){let i=e(this.__entries__,t);return this.__entries__[i][1]}set(t,i){let s=e(this.__entries__,t);~s?this.__entries__[s][1]=i:this.__entries__.push([t,i])}delete(t){let i=this.__entries__,s=e(i,t);~s&&i.splice(s,1)}has(t){return!!~e(this.__entries__,t)}}}(),i=t?window.Map:class extends e{get size(){return this.__entries__.length}clear(){this.__entries__.splice(0,this.__entries__.length)}entries(){return this.__entries__.slice()}keys(){return this.__entries__.map(t=>t[0])}values(){return this.__entries__.map(t=>t[1])}forEach(t,e=null){for(const i of this.__entries__)t.call(e,i[1],i[0])}},s=window.performance&&window.performance.now?()=>window.performance.now():()=>Date.now(),r="function"==typeof window.MutationObserver,n=window.requestAnimationFrame?window.requestAnimationFrame:t=>setTimeout(()=>t(s()),1e3/60);function o(t,e=0){let i=!1;return function(...s){!1!==i&&clearTimeout(i),i=setTimeout(()=>{i=!1,t.apply(this,s)},e)}}function h(t){const e={};for(const i of Object.keys(t))e[i]={value:t[i]};return Object.defineProperties({},e)}function u(t=0,e=0,i=0,s=0){return{left:t,top:e,width:i,height:s,bottom:e+s,right:t+i}}function c(t){return t===document.documentElement?u(0,0,t.clientWidth,t.clientHeight):t.getBoundingClientRect()}function a(t){return t.width*t.height}class l{constructor(t,e,i,s,r,n){Object.defineProperties(this,{boundingClientRect:{value:e},intersectionRatio:{value:s},intersectionRect:{value:h(i)},rootBounds:{value:h(r)},target:{value:t},time:{value:n}})}}const w=u();function d(t,e){const i=Math.max(e.left,t.left),s=Math.min(e.right,t.right),r=Math.max(e.top,t.top);return u(i,r,s-i,Math.min(e.bottom,t.bottom)-r)}class f{constructor(t,e){this.target=t,this.observer=e,this.prevTargetRect=w,this.prevThreshold=0,this.prevRatio=0}updateIntersection(t,e){let i,r=c(this.target),n=this.getIntersectionData(t,e,r),o=+n.exists,h=n.ratio!==this.prevRatio,u=!((a=r).top===(d=this.prevTargetRect).top&&a.left===d.left&&a.right===d.right&&a.bottom===d.bottom);var a,d,f;if(n.exists&&(0!==(f=r).height||0!==f.width)&&(o=this.observer.getThresholdGreaterThan(n.ratio)),i=o!==this.prevThreshold,this.prevTargetRect=r,this.prevThreshold=o,this.prevRatio=n.ratio,n.exists||(n.ratio=0,n.rect=w),i){const t=new l(this.target,r,n.rect,n.ratio,e,s());this.observer.queueEntry(t)}return{ratioChanged:h,thresholdChanged:i,targetRectChanged:u}}getIntersectionData(t,e,i){const s=this.target;i||(i=c(this.target)),e||(e=c(t));let r=function(t,e){const i=document.documentElement;return t!==i&&!i.contains(t)||!t.contains(e)}(t,s),n=r?w:function(t,e,i,s){let r=s,n=e.parentNode,o=!1;for(;!o;){let e=null;n===t||1!==n.nodeType?(o=!0,e=i):"visible"!==window.getComputedStyle(n).overflow&&(e=c(n)),e&&(r=d(r,e)),n=n.parentNode}return r}(t,s,e,i),o=!r&&n.width>=0&&n.height>=0;return{rect:n,ratio:a(n)/a(i)||0,exists:o}}}class p{constructor(t,e={},s,r){if("function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");if("object"!=typeof e)throw new TypeError("parameter 2 is not an object.");if("root"in e&&!(e.root instanceof Element))throw new TypeError("member root is not of type Element.");const n=function(t=0){let e=t;return Array.isArray(t)?t.length||(e=[0]):e=[t],e.map(t=>{if(t=Number(t),!window.isFinite(t))throw new TypeError("The provided double value is non-finite.");if(t<0||t>1)throw new RangeError("Threshold values must be between 0 and 1.");return t}).sort()}(e.threshold),o=function(t="0px"){if((t=(t+"").split(/\s+/)).length>4)throw new Error("Extra text found at the end of rootMargin.");return t[0]=t[0]||"0px",t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],{rawData:t.join(" "),parsedData:t.map(t=>{let[,e,i]=/^(-?\d*\.?\d+)(px|%)$/.exec(t)||[];const s="px"===i;if(e=parseFloat(e),!window.isFinite(e))throw new Error("rootMargin must be specified in pixels or percent.");return s||(e/=100),{value:e,pixels:s}})}}(e.rootMargin);this.root=e.root||null,this.rootMargin=o.rawData,this.thresholds=Object.freeze(n),this._root=e.root||document.documentElement,this._callback=t,this._rootMargin=o.parsedData,this._targets=new i,this._quedEntries=[],this._publicObserver=r||this,this.controller=s}observe(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(t instanceof Element))throw new TypeError('parameter 1 is not of type "Element".');let e=this._targets;e.has(t)||(e.set(t,new f(t,this)),this.controller.isConnected(this)||this.controller.connect(this),this.controller.startUpdateCycle())}unobserve(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(t instanceof Element))throw new TypeError('parameter 1 is not of type "Element".');let e=this._targets;e.has(t)&&e.delete(t),e.size||this.disconnect()}disconnect(){this._targets.clear(),this.controller.disconnect(this)}takeRecords(){return this._quedEntries.splice(0)}notifySubscriber(){const t=this.takeRecords(),e=this._publicObserver;t.length&&this._callback.call(e,t,e)}queueEntry(t){this._quedEntries.push(t)}hasEntries(){return!!this._quedEntries.length}updateObservations(){let t=this._root,e=this.getRootRect(),i=!1;return this._targets.forEach(s=>{const r=s.updateIntersection(t,e);(r.ratioChanged||r.targetRectChanged)&&(i=!0)}),i}getThresholdGreaterThan(t){let e=this.thresholds,i=e.length,s=0;for(;s<i&&e[s]<=t;)++s;return s}getRootRect(){return function(t,e){e=e.map((e,i)=>{let s=e.value;return e.pixels||(s*=i%2?t.width:t.height),s});const i={top:t.top-e[0],right:t.right+e[1],bottom:t.bottom+e[2],left:t.left-e[3]};return i.width=i.right-i.left,i.height=i.bottom-i.top,i}(c(this._root),this._rootMargin)}}const m=new class{constructor(t=50,e=!1){this._idleTimeout=t,this._trackHovers=e,this._cycleStartTime=-1,this._isUpdateScheduled=!1,this._repeatCycle=!1,this._hoverInitiated=!1,this._mutationsObserver=null,this._isListening=!1,this._observers=[],this.startUpdateCycle=this.startUpdateCycle.bind(this),this.scheduleUpdate=this.scheduleUpdate.bind(this),this._onMutation=this._onMutation.bind(this),this._repeatHandler=o(this.scheduleUpdate,200),this._onMouseOver=o(this.startUpdateCycle,200)}get idleTimeout(){return this._idleTimeout}set idleTimeout(t){this._idleTimeout=t}connect(t){this.isConnected(t)||this._observers.push(t),this._isListening||this._initListeners()}disconnect(t){let e=this._observers,i=e.indexOf(t);~i&&e.splice(i,1),!e.length&&this._isListening&&this._removeListeners()}isConnected(t){return!!~this._observers.indexOf(t)}_updateObservers(){let t=!1;for(const e of this._observers)e.updateObservations()&&(t=!0),e.hasEntries()&&e.notifySubscriber();return t}startUpdateCycle(){this._cycleStartTime=s(),this.scheduleUpdate()}scheduleUpdate(t){if("number"==typeof t){const t=this._updateObservers();if(this._isUpdateScheduled=!1,!this._wasCycleStarted())return;t?this.startUpdateCycle():this._hasIdleTimeEnded()?this._onCycleEnded():this.scheduleUpdate()}else this._isUpdateScheduled||(n(this.scheduleUpdate),this._isUpdateScheduled=!0)}_hasIdleTimeEnded(){return s()-this._cycleStartTime>this._idleTimeout}_wasCycleStarted(){return-1!==this._cycleStartTime}_onCycleEnded(){this._cycleStartTime=-1,this._repeatCycle&&(this._cycleStartTime=0,this._repeatHandler())}_initListeners(){this._isListening||(this._isListening=!0,window.addEventListener("resize",this.startUpdateCycle,!0),window.addEventListener("scroll",this.scheduleUpdate,!0),this._trackHovers&&this._addHoverListener(),r?(this._mutationsObserver=new MutationObserver(this._onMutation),this._mutationsObserver.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(this._repeatCycle=!0,window.addEventListener("click",this.startUpdateCycle,!0),this.startUpdateCycle()))}_removeListeners(){this._isListening&&(window.removeEventListener("resize",this.startUpdateCycle,!0),window.removeEventListener("scroll",this.scheduleUpdate,!0),this._removeHoverListener(),r?this._mutationsObserver&&(this._mutationsObserver.disconnect(),this._mutationsObserver=null):(this._repeatCycle=!1,window.removeEventListener("click",this.startUpdateCycle,!0)),this._isListening=!1)}enableHover(){this._trackHovers=!0,this._isListening&&this._addHoverListener()}disableHover(){this._trackHovers=!1,this._removeHoverListener()}isHoverEnabled(){return this._trackHovers}_addHoverListener(){this._hoverInitiated||(window.addEventListener("mouseover",this._onMouseOver,!0),this._hoverInitiated=!0)}_removeHoverListener(){this._hoverInitiated&&(window.removeEventListener("mouseover",this._onMouseOver,!0),this._hoverInitiated=!1)}_onMutation(t){t.every(t=>"attributes"!==t.type)?this.scheduleUpdate():this.startUpdateCycle()}},b=new e;class v{constructor(t,e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");const i=new p(t,e,m,this);Object.defineProperties(this,{root:{value:i.root},thresholds:{value:i.thresholds},rootMargin:{value:i.rootMargin}}),b.set(this,i)}static get idleTimeout(){return m.idleTimeout}static set idleTimeout(t){if("number"!=typeof t)throw new TypeError('type of "idleTimeout" value must be a number.');if(typeof t<0)throw new TypeError('"idleTimeout" value must be greater than 0.');m.idleTimeout=t}static get trackHovers(){return m.isHoverEnabled()}static set trackHovers(t){if("boolean"!=typeof t)throw new TypeError('type of "trackHovers" value must be a boolean.');t?m.enableHover():m.disableHover()}}let y;["observe","unobserve","disconnect","takeRecords"].forEach(t=>{v.prototype[t]=function(){return b.get(this)[t](...arguments)}}),y="function"==typeof window.IntersectionObserver?window.IntersectionObserver:v;const E=y,T=(t,e,i)=>{new E(e,i).observe(t)};export{T as o};