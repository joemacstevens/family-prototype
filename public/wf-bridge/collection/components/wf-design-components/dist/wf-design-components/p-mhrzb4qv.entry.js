import{r as t,c as s,h as i,g as e}from"./p-5f633ccc.js";import"./p-74149bb1.js";import{h as o}from"./p-6675dcbc.js";import{P as h}from"./p-f02f0fad.js";import{o as r}from"./p-17dc0833.js";import{g as n,a as l,c as a,b as c,e as u,m as p,d,f}from"./p-d5bb5fa2.js";var g=function(t,s,i,e){var o,h=arguments.length,r=h<3?s:null===e?e=Object.getOwnPropertyDescriptor(s,i):e;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,s,i,e);else for(var n=t.length-1;n>=0;n--)(o=t[n])&&(r=(h<3?o(r):h>3?o(s,i,r):o(s,i))||r);return h>3&&r&&Object.defineProperty(s,i,r),r};const m=class{constructor(i){t(this,i),this.level=1,this.noArrow=!1,this.overlap=0,this.opened=!1,this.focusAttribute="focusable",this.triggerTabIndex="0",this.arrowPointer=!0,this.trigger="click",this.enableOpenChangedEvent=!1,this.detached=!1,this.visible=!0,this.spaces={vertical:"bottom",horizontal:"center"},this.screenGrid={columns:3,rows:3},this.triggerSelector=".flyout-trigger",this.focusFirstChild=!1,this.handleClick=t=>{const{trigger:s,opened:i}=this;"none"===s||"click"!==s&&1===t.detail||(0===t.detail&&(this.focusFirstChild=!0),t.preventDefault(),i?this.closeFlyout("MOUSE_CLICK"):this.openFlyout("MOUSE_CLICK"))},this.handleMouseEnter=()=>{"hover"!==this.trigger||this.opened||this.openFlyout("MOUSE_ENTER")},this.handleMouseLeave=()=>{"hover"===this.trigger&&this.opened&&this.closeFlyout("MOUSE_LEAVE",!0)},this.keyPressCases=(t,s,i)=>({Enter:()=>{s&&(t.stopPropagation(),this.focusFirstChild=!0,this.opened?this.closeFlyout("ENTER_KEY"):this.openFlyout("ENTER_KEY"))},ArrowDown:()=>{s&&(t.preventDefault(),this.focusFirstChild=!0,this.openFlyout("ARROW_DOWN")),-1!==i&&(t.preventDefault(),this.focusNextItem(i))},ArrowUp:()=>{-1!==i&&(t.preventDefault(),this.focusPrevItem(i))},Tab:()=>{-1!==i&&(t.preventDefault(),this.focusNextItem(i))},Escape:()=>{this.opened&&t.stopPropagation(),this.closeFlyout("ESC_KEY")}}[t.key]),this.spacesValidity=t=>({vertical:t.vertical?t.vertical:this.spaces.vertical,horizontal:t.horizontal?t.horizontal:this.spaces.horizontal}),this.flyoutOpenChanged=s(this,"flyoutOpenChanged",7),this.docOpen=s(this,"open",7),this.docWfOpen=s(this,"wfOpen",7),this.docClose=s(this,"close",7),this.docWfClose=s(this,"wfClose",7)}componentWillLoad(){this.handleClick=this.handleClick.bind(this),this.handleKeyPress=this.handleKeyPress.bind(this),this.handleMouseEnter=this.handleMouseEnter.bind(this),this.handleMouseLeave=this.handleMouseLeave.bind(this),this.focusableElementsSelector=`button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"]), [${this.focusAttribute}]`,this.focusableElements=[],this.slotElement=this.host.querySelector("[slot=trigger]"),this.placement&&(this.spaces=this.updateSpaces(this.placement))}emitOpenChanged(){this.enableOpenChangedEvent&&this.flyoutOpenChanged.emit(this.opened),this.slotElement&&Array.from(this.slotElement.children).forEach(t=>t.classList.toggle("trigger-active"))}searchFocusableInComponent(t,s){return t.shadowRoot.querySelector(s)||t}queryShadowRoot(t,s){return t.shadowRoot.querySelector(s)}getAllFocusableItems(){const t=n(this.host,".flyout-content slot");let s=[];return t.forEach(t=>{const i=Array.from(t.querySelectorAll(this.focusableElementsSelector)).filter(t=>t.offsetWidth);s=[...s,...i]}),s}setFocusToChild(){let t;this.focusableElements=this.getAllFocusableItems(),t=this.focusableElements[0],t&&(t.classList.contains("hydrated")&&(t=this.searchFocusableInComponent(t,this.focusableElementsSelector)),t.focus())}closeFlyout(t,s=!1){if(this.opened=!1,this.close.emit(t),s)return;let i;i="-1"===this.triggerTabIndex?this.host.querySelector("[slot=trigger]").querySelector(this.focusableElementsSelector):this.queryShadowRoot(this.host,this.triggerSelector),i&&i.focus()}openFlyout(t){this.opened=!0,this.open.emit(t)}focusPrevItem(t){this.focusableElements[t<=0?this.focusableElements.length-1:t-1].focus()}focusNextItem(t){this.focusableElements[t>=this.focusableElements.length-1?0:t+1].focus()}searchForFocusableItem(t){return this.focusableElements.indexOf(t)}handleKeyPress(t){const s=t.path[0],i=this.searchForFocusableItem(s),e=s.classList.contains("flyout-trigger");["Enter","ArrowDown","ArrowUp","Tab","Escape"].includes(t.key)&&"none"!==this.trigger&&this.keyPressCases(t,e,i)()}clickOutside(t){if(!this.opened||"click"!==this.trigger)return;let s=[];t.composedPath&&(s=t.composedPath());const i=[this.host,this.triggerEl];s.some(t=>i.includes(t))||this.closeFlyout("OUTSIDE_CLICK")}applyStyles(t,{top:s,right:i,bottom:e,left:o}){const{style:h}=t;s?h.top=s:h.removeProperty("top"),i?h.right=i:h.removeProperty("right"),e?h.bottom=e:h.removeProperty("bottom"),o?h.left=o:h.removeProperty("left")}calculateArrowPointer(t){const{triggerEl:s,flyoutElement:i,applyStyles:e}=this,o=i.querySelector(".arrow-pointer"),h=o.getBoundingClientRect().width;e(o,l(`${t.vertical}-${t.horizontal}`,s,h))}updateSpaces(t){return{top:{vertical:"bottom",horizontal:"center"},bottom:{vertical:"top",horizontal:"center"},left:{vertical:"middle",horizontal:"right"},right:{vertical:"middle",horizontal:"left"}}[t]}updatePosition(){const{opened:t,triggerEl:s,flyoutElement:i,screenGrid:e,level:h,overlap:r,noArrow:n,arrowPointer:l,spacesValidity:u}=this;if(!t||!s||!i)return;let p;this.placement&&(p=this.updateSpaces(this.placement));const d=1===h?a(s,i,e,p):c(s,i,r,p),{placement:f,spaces:g}=d;if(i.style.top=o(f.top),i.style.left=o(f.left),!n||l){const t=i.querySelector(".flyout-content"),s=`flyout-content-${this.spaces.vertical}-${this.spaces.horizontal}`,e=u(g),o=`flyout-content-${e.vertical}-${e.horizontal}`;s!==o&&(t.classList.remove(s),t.classList.add(o)),this.calculateArrowPointer(e),this.spaces=e}requestAnimationFrame(this.updatePosition.bind(this))}componentDidLoad(){this.setupTriggerElement(),this.componentDidUpdate()}componentDidUpdate(){const{host:t,opened:s}=this;this.flyoutElement=this.queryShadowRoot(t,".flyout-content-wrapper"),s&&(this.focusFirstChild&&(this.focusFirstChild=!1,this.setFocusToChild()),this.updatePosition())}setupTriggerElement(){if(this.detached){const t=n(this.host,".flyout-trigger slot");if(0===t.length)throw new Error(u.NOT_FOUND_DETACHED_ELEMENT);if(t.length>1)throw new Error(u.MORE_THAN_ONE_ELEMENT);this.triggerEl=t[0],this.detachHost()}else this.triggerEl=this.host.shadowRoot.querySelector(".flyout-trigger");this.addEventListeners(),this.addIntersectionObserver()}detachHost(){p(this.host,this.triggerEl),d(this.host,this.triggerEl),f(this.host)}addEventListeners(){const{triggerEl:t,handleMouseEnter:s,handleMouseLeave:i,handleClick:e}=this;t.addEventListener("mouseenter",s),t.addEventListener("mouseleave",i),t.addEventListener("click",e)}addIntersectionObserver(){const{triggerEl:t}=this;r(t,t=>{this.opened&&(t[0].isIntersecting?(this.visible=!0,this.updatePosition()):this.visible=!1)},{threshold:[0]})}componentDidUnload(){const{triggerEl:t,handleMouseEnter:s,handleMouseLeave:i,handleClick:e}=this;t.removeEventListener("mouseenter",s),t.removeEventListener("mouseleave",i),t.removeEventListener("click",e)}render(){const{arrowPointer:t,noArrow:s,spaces:e,opened:o,visible:h,trigger:r,triggerTabIndex:n,handleMouseEnter:l,handleMouseLeave:a}=this,c={"flyout-content-wrapper":!0,"no-arrow":!t||!!s},u={"flyout-content":!0,[`flyout-content-${e.vertical}-${e.horizontal}`]:!0};return i("div",{class:"flyout",onMouseEnter:l,onMouseLeave:a},i("div",{class:{"flyout-trigger":!0,"flyout-trigger-none":"none"===r},tabindex:n},i("slot",{name:"trigger"})),o&&h?i("div",{class:c},i("div",{class:u},i("span",{class:"arrow-mask"},i("span",{class:"arrow-pointer"})),i("div",{class:"flyout-content-slot-wrapper"},i("slot",null)))):i("div",null))}get host(){return e(this)}static get watchers(){return{opened:["emitOpenChanged"]}}static get style(){return":host{display:inline-block}.flyout{position:relative;font-family:var(--flyout-font-family);color:var(--flyout-text-color,var(--color-text-primary,var(--text-primary-color,var(--text-color,#1c1c1c))))}.flyout-trigger{cursor:pointer}.flyout-trigger-none{cursor:auto}.flyout-content{position:relative;background:var(--flyout-background,#fff);border-color:var(--flyout-background,#fff);-webkit-box-shadow:var(--flyout-box-shadow,var(--flyout-shadow,2px 4px 8px 0) var(--flyout-shadow-color,rgba(28,28,28,.5)));box-shadow:var(--flyout-box-shadow,var(--flyout-shadow,2px 4px 8px 0) var(--flyout-shadow-color,rgba(28,28,28,.5)));min-height:var(--flyout-min-height,200px);display:-ms-flexbox;display:flex}.flyout-content-wrapper{-webkit-box-sizing:border-box;box-sizing:border-box;position:fixed;z-index:var(--flyout-z-index,1000);top:100%;padding:calc(var(--flyout-distance, var(--spacing-xxs, 6px)) + var(--flyout-arrow-size, 8px));min-width:var(--flyout-min-width,180px);max-width:var(--flyout-max-width,70%);width:var(--flyout-width,auto);white-space:normal;word-break:break-word}.flyout-content-wrapper .arrow-mask{display:block;position:absolute;height:calc(var(--flyout-arrow-size, 8px) + var(--spacing-xxs, 6px));width:calc(var(--flyout-arrow-size, 8px) + var(--spacing-xxs, 6px))}.flyout-content-wrapper .arrow-mask .arrow-pointer{position:absolute;left:auto;top:auto;width:calc(var(--flyout-arrow-size, 8px) * 1.41);height:calc(var(--flyout-arrow-size, 8px) * 1.41);background:var(--flyout-background,#fff);-webkit-box-shadow:var(--flyout-shadow,2px 4px 8px 0) var(--flyout-shadow-color,rgba(28,28,28,.5));box-shadow:var(--flyout-shadow,2px 4px 8px 0) var(--flyout-shadow-color,rgba(28,28,28,.5));-webkit-transform:rotate(45deg);transform:rotate(45deg)}.flyout-content-wrapper.no-arrow{padding:var(--flyout-distance,var(--spacing-xxs,6px))}.flyout-content-wrapper.no-arrow .arrow-mask,.flyout-content-wrapper.no-arrow .arrow-pointer{display:none}.flyout-content-slot-wrapper{padding:var(--flyout-padding,var(--spacing-xxs,6px));background:var(--flyout-background,#fff);position:relative;-ms-flex-item-align:stretch;align-self:stretch;width:100%}.flyout-content-left-top .arrow-mask{right:100%;top:0;height:100%}.flyout-content-left-top .arrow-mask .arrow-pointer{right:calc(-1 * calc(var(--flyout-arrow-size, 8px) * 1.41)/ 2);top:unset}.flyout-content-left-bottom .arrow-mask{right:100%;bottom:0;height:100%}.flyout-content-left-bottom .arrow-mask .arrow-pointer{right:calc(-1 * calc(var(--flyout-arrow-size, 8px) * 1.41)/ 2);bottom:unset}.flyout-content-right-top .arrow-mask{left:100%;top:0;height:100%}.flyout-content-right-top .arrow-mask .arrow-pointer{left:calc(-1 * calc(var(--flyout-arrow-size, 8px) * 1.41)/ 2);top:unset}.flyout-content-right-bottom .arrow-mask{left:100%;bottom:0;height:100%}.flyout-content-right-bottom .arrow-mask .arrow-pointer{left:calc(-1 * calc(var(--flyout-arrow-size, 8px) * 1.41)/ 2);bottom:unset}.flyout-content-top-left .arrow-mask{bottom:100%;left:0;width:100%}.flyout-content-top-left .arrow-mask .arrow-pointer{bottom:calc(-1 * calc(var(--flyout-arrow-size, 8px) * 1.41)/ 2);left:var(--flyout-arrow-size,8px)}.flyout-content-top-center .arrow-mask{bottom:100%;left:0;width:100%}.flyout-content-top-center .arrow-mask .arrow-pointer{bottom:calc(-1 * calc(var(--flyout-arrow-size, 8px) * 1.41)/ 2);left:calc(50% - calc(var(--flyout-arrow-size, 8px) * 1.41)/ 2)}.flyout-content-top-right .arrow-mask{bottom:100%;right:0;width:100%}.flyout-content-top-right .arrow-mask .arrow-pointer{bottom:calc(-1 * calc(var(--flyout-arrow-size, 8px) * 1.41)/ 2);right:var(--flyout-arrow-size,8px)}.flyout-content-middle-left .arrow-mask{top:100%;right:0;height:100%}.flyout-content-middle-left .arrow-mask .arrow-pointer{top:calc(-1 * calc(var(--flyout-arrow-size, 8px) * 1.41)/ 2);right:100%}.flyout-content-middle-right .arrow-mask{top:100%;left:0;height:100%}.flyout-content-middle-right .arrow-mask .arrow-pointer{top:calc(-1 * calc(var(--flyout-arrow-size, 8px) * 1.41)/ 2);left:100%}.flyout-content-bottom-left .arrow-mask{top:100%;left:0;width:100%}.flyout-content-bottom-left .arrow-mask .arrow-pointer{top:calc(-1 * calc(var(--flyout-arrow-size, 8px) * 1.41)/ 2);left:var(--flyout-arrow-size,8px)}.flyout-content-bottom-center .arrow-mask{top:100%;left:0;width:100%}.flyout-content-bottom-center .arrow-mask .arrow-pointer{top:calc(-1 * calc(var(--flyout-arrow-size, 8px) * 1.41)/ 2);left:calc(50% - calc(var(--flyout-arrow-size, 8px) * 1.41)/ 2)}.flyout-content-bottom-right .arrow-mask{top:100%;right:0;width:100%}.flyout-content-bottom-right .arrow-mask .arrow-pointer{top:calc(-1 * calc(var(--flyout-arrow-size, 8px) * 1.41)/ 2);right:var(--flyout-arrow-size,8px)}"}};g([h()],m.prototype,"open",void 0),g([h()],m.prototype,"close",void 0);export{m as wf_flyout};