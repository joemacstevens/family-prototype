import{r as t,c as s,h as i,g as e}from"./p-5f633ccc.js";import"./p-74149bb1.js";import{f as o}from"./p-bd4e6cc9.js";import{a as h,c as r,b as n}from"./p-1869f37d.js";const l=class{constructor(i){t(this,i),this.level=1,this.noArrow=!1,this.overlap=0,this.opened=!1,this.focusAttribute="focusable",this.triggerTabIndex="0",this.arrowPointer=!0,this.trigger="click",this.enableOpenChangedEvent=!1,this.spaces={vertical:"bottom",horizontal:"center"},this.screenGrid={columns:3,rows:3},this.triggerSelector=".flyout-trigger",this.focusFirstChild=!1,this.keyPressCases=(t,s,i)=>({Enter:()=>{s&&(t.stopPropagation(),this.focusFirstChild=!0,this.opened?this.closeFlyout("ENTER_KEY"):this.openFlyout("ENTER_KEY"))},ArrowDown:()=>{s&&(t.preventDefault(),this.focusFirstChild=!0,this.openFlyout("ARROW_DOWN")),-1!==i&&(t.preventDefault(),this.focusNextItem(i))},ArrowUp:()=>{-1!==i&&(t.preventDefault(),this.focusPrevItem(i))},Tab:()=>{-1!==i&&(t.preventDefault(),this.focusNextItem(i))},Escape:()=>{this.opened&&t.stopPropagation(),this.closeFlyout("ESC_KEY")}}[t.key]),this.spacesValidity=t=>({vertical:t.vertical?t.vertical:this.spaces.vertical,horizontal:t.horizontal?t.horizontal:this.spaces.horizontal}),this.flyoutOpenChanged=s(this,"flyoutOpenChanged",7),this.wfOpen=s(this,"wfOpen",7),this.wfClose=s(this,"wfClose",7)}componentWillLoad(){this.handleClick=this.handleClick.bind(this),this.handleKeyPress=this.handleKeyPress.bind(this),this.handleMouseEnter=this.handleMouseEnter.bind(this),this.handleMouseLeave=this.handleMouseLeave.bind(this),this.focusableElementsSelector=`button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"]), [${this.focusAttribute}]`,this.focusableElements=[],this.slotElement=this.host.querySelector("[slot=trigger]"),this.placement&&(this.spaces=this.updateSpaces(this.placement))}emitOpenChanged(){this.enableOpenChangedEvent&&this.flyoutOpenChanged.emit(this.opened),this.slotElement&&Array.from(this.slotElement.children).forEach(t=>t.classList.toggle("trigger-active"))}searchFocusableInComponent(t,s){return t.shadowRoot.querySelector(s)||t}queryShadowRoot(t,s){return t.shadowRoot.querySelector(s)}getElementsFromSlot(){const t=this.host.shadowRoot.querySelector(".flyout-content slot");return t?t.assignedElements():[]}getAllFocusableItems(){const t=this.getElementsFromSlot();let s=[];return t.forEach(t=>{const i=Array.from(t.querySelectorAll(this.focusableElementsSelector)).filter(t=>t.offsetWidth);s=[...s,...i]}),s}setFocusToChild(){let t;this.focusableElements=this.getAllFocusableItems(),t=this.focusableElements[0],t&&(t.classList.contains("hydrated")&&(t=this.searchFocusableInComponent(t,this.focusableElementsSelector)),t.focus())}closeFlyout(t,s=!1){if(this.opened=!1,this.wfClose.emit(t),s)return;let i;i="-1"===this.triggerTabIndex?this.host.querySelector("[slot=trigger]").querySelector(this.focusableElementsSelector):this.queryShadowRoot(this.host,this.triggerSelector),i&&i.focus()}openFlyout(t){this.opened=!0,this.wfOpen.emit(t)}handleClick(t){const{trigger:s,opened:i}=this;"none"===s||"click"!==s&&1===t.detail||(0===t.detail&&(this.focusFirstChild=!0),t.preventDefault(),i?this.closeFlyout("MOUSE_CLICK"):this.openFlyout("MOUSE_CLICK"))}handleMouseEnter(){"hover"!==this.trigger||this.opened||this.openFlyout("MOUSE_ENTER")}handleMouseLeave(){"hover"===this.trigger&&this.opened&&this.closeFlyout("MOUSE_LEAVE",!0)}focusPrevItem(t){this.focusableElements[t<=0?this.focusableElements.length-1:t-1].focus()}focusNextItem(t){this.focusableElements[t>=this.focusableElements.length-1?0:t+1].focus()}searchForFocusableItem(t){return this.focusableElements.indexOf(t)}handleKeyPress(t){const s=t.path[0],i=this.searchForFocusableItem(s),e=s.classList.contains("flyout-trigger");["Enter","ArrowDown","ArrowUp","Tab","Escape"].includes(t.key)&&"none"!==this.trigger&&this.keyPressCases(t,e,i)()}applyStyles(t,{top:s,right:i,bottom:e,left:o}){const{style:h}=t;s?h.top=s:h.removeProperty("top"),i?h.right=i:h.removeProperty("right"),e?h.bottom=e:h.removeProperty("bottom"),o?h.left=o:h.removeProperty("left")}calculateArrowPointer(t){const{triggerEl:s,flyoutElement:i,applyStyles:e}=this;e(i.querySelector(".arrow-pointer"),h(`${t.vertical}-${t.horizontal}`,s))}updateSpaces(t){return{top:{vertical:"bottom",horizontal:"center"},bottom:{vertical:"top",horizontal:"center"},left:{vertical:"middle",horizontal:"right"},right:{vertical:"middle",horizontal:"left"}}[t]}updatePosition(){const{opened:t,triggerEl:s,flyoutElement:i,screenGrid:e,level:h,overlap:l,noArrow:a,arrowPointer:c,spacesValidity:u}=this;if(!t||!s||!i)return;let p;this.placement&&(p=this.updateSpaces(this.placement));const d=1===h?r(s,i,e,p):n(s,i,l,p),{placement:g,spaces:f}=d;i.style.top=o(g.top),i.style.left=o(g.left);const m=i.querySelector(".flyout-content");let y=`flyout-content-${this.spaces.vertical}-${this.spaces.horizontal}`;m.classList.remove(y);const E=u(f);a&&!c||(y=`flyout-content-${E.vertical}-${E.horizontal}`,m.classList.add(y),this.calculateArrowPointer(E)),this.spaces=E,requestAnimationFrame(this.updatePosition.bind(this))}componentDidLoad(){document.addEventListener("click",t=>{const{host:s,opened:i,trigger:e}=this;let o=[];o=t.composedPath(),i&&"none"!==e&&!o.includes(s)&&this.closeFlyout("OUTSIDE_CLICK")}),this.triggerEl=this.queryShadowRoot(this.host,".flyout-trigger"),this.componentDidUpdate()}componentDidUpdate(){const{host:t,opened:s}=this;this.flyoutElement=this.queryShadowRoot(t,".flyout-content-wrapper"),s&&(this.focusFirstChild&&(this.focusFirstChild=!1,this.setFocusToChild()),this.updatePosition())}render(){const{arrowPointer:t,noArrow:s,spaces:e,opened:o,trigger:h,triggerTabIndex:r,handleClick:n,handleMouseEnter:l,handleMouseLeave:a}=this,c={"flyout-content":!0,[`flyout-content-${e.vertical}-${e.horizontal}`]:!0,"no-arrow":!t||!!s};return i("div",{class:"flyout",onMouseEnter:l,onMouseLeave:a},i("div",{class:{"flyout-trigger":!0,"flyout-trigger-none":"none"===h},onClick:n,tabindex:r},i("slot",{name:"trigger"})),o?i("div",{class:"flyout-content-wrapper"},i("div",{class:c},i("span",{class:"arrow-mask"},i("span",{class:"arrow-pointer"})),i("div",{class:"flyout-content-slot-wrapper"},i("slot",null)))):i("div",null))}get host(){return e(this)}static get watchers(){return{opened:["emitOpenChanged"]}}static get style(){return":host{display:inline-block;max-width:var(--flyout-max-width,70%)}.flyout{position:relative;font-family:var(--flyout-font-family);color:var(--flyout-text-color,var(--color-text-primary,var(--text-primary-color,var(--text-color,#1c1c1c))))}.flyout-trigger{cursor:pointer}.flyout-trigger-none{cursor:auto}.flyout-content{position:relative;background:var(--flyout-background,#fff);border-color:var(--flyout-background,#fff);-webkit-box-shadow:var(--flyout-shadow,2px 4px 8px 0) var(--flyout-shadow-color,rgba(27,27,26,.5));box-shadow:var(--flyout-shadow,2px 4px 8px 0) var(--flyout-shadow-color,rgba(27,27,26,.5));min-height:var(--flyout-min-height,200px);min-width:var(--flyout-min-width,150px);display:-ms-flexbox;display:flex}.flyout-content-wrapper{position:fixed;z-index:var(--flyout-z-index,1000);top:100%;padding:var(--flyout-distance,10px);white-space:normal;word-break:break-word}.flyout-content-slot-wrapper{padding:var(--flyout-padding,var(--spacing-xxxs,3px));background:var(--flyout-background,#fff);position:relative;-ms-flex-item-align:stretch;align-self:stretch;width:100%}.flyout-content .arrow-mask{display:block}.flyout-content .arrow-mask,.flyout-content .arrow-mask .arrow-pointer{position:absolute;height:var(--flyout-arrow-size,12px);width:var(--flyout-arrow-size,12px)}.flyout-content .arrow-mask .arrow-pointer{left:auto;top:auto;background:var(--flyout-background,#fff);-webkit-box-shadow:var(--flyout-shadow,2px 4px 8px 0) var(--flyout-shadow-color,rgba(27,27,26,.5));box-shadow:var(--flyout-shadow,2px 4px 8px 0) var(--flyout-shadow-color,rgba(27,27,26,.5));-webkit-transform:rotate(45deg);transform:rotate(45deg)}.flyout-content.no-arrow .arrow-mask,.flyout-content.no-arrow .arrow-pointer{display:none}.flyout-content-left-top .arrow-mask{right:100%;top:0;height:100%}.flyout-content-left-top .arrow-mask .arrow-pointer{right:calc(-1 * var(--flyout-arrow-size, 12px)/ 2);top:unset}.flyout-content-left-bottom .arrow-mask{right:100%;bottom:0;height:100%}.flyout-content-left-bottom .arrow-mask .arrow-pointer{right:calc(-1 * var(--flyout-arrow-size, 12px)/ 2);bottom:unset}.flyout-content-right-top .arrow-mask{left:100%;top:0;height:100%}.flyout-content-right-top .arrow-mask .arrow-pointer{left:calc(-1 * var(--flyout-arrow-size, 12px)/ 2);top:unset}.flyout-content-right-bottom .arrow-mask{left:100%;bottom:0;height:100%}.flyout-content-right-bottom .arrow-mask .arrow-pointer{left:calc(-1 * var(--flyout-arrow-size, 12px)/ 2);bottom:unset}.flyout-content-top-left .arrow-mask{bottom:100%;left:0;width:100%}.flyout-content-top-left .arrow-mask .arrow-pointer{bottom:calc(-1 * var(--flyout-arrow-size, 12px)/ 2);left:var(--flyout-arrow-size,12px)}.flyout-content-top-center .arrow-mask{bottom:100%;left:0;width:100%}.flyout-content-top-center .arrow-mask .arrow-pointer{bottom:calc(-1 * var(--flyout-arrow-size, 12px)/ 2);left:calc(50% - var(--flyout-arrow-size, 12px)/ 2)}.flyout-content-top-right .arrow-mask{bottom:100%;right:0;width:100%}.flyout-content-top-right .arrow-mask .arrow-pointer{bottom:calc(-1 * var(--flyout-arrow-size, 12px)/ 2);right:var(--flyout-arrow-size,12px)}.flyout-content-middle-left .arrow-mask{top:100%;right:0;height:100%}.flyout-content-middle-left .arrow-mask .arrow-pointer{top:calc(-1 * var(--flyout-arrow-size, 12px)/ 2);right:100%}.flyout-content-middle-right .arrow-mask{top:100%;left:0;height:100%}.flyout-content-middle-right .arrow-mask .arrow-pointer{top:calc(-1 * var(--flyout-arrow-size, 12px)/ 2);left:100%}.flyout-content-bottom-left .arrow-mask{top:100%;left:0;width:100%}.flyout-content-bottom-left .arrow-mask .arrow-pointer{top:calc(-1 * var(--flyout-arrow-size, 12px)/ 2);left:var(--flyout-arrow-size,12px)}.flyout-content-bottom-center .arrow-mask{top:100%;left:0;width:100%}.flyout-content-bottom-center .arrow-mask .arrow-pointer{top:calc(-1 * var(--flyout-arrow-size, 12px)/ 2);left:calc(50% - var(--flyout-arrow-size, 12px)/ 2)}.flyout-content-bottom-right .arrow-mask{top:100%;right:0;width:100%}.flyout-content-bottom-right .arrow-mask .arrow-pointer{top:calc(-1 * var(--flyout-arrow-size, 12px)/ 2);right:var(--flyout-arrow-size,12px)}"}};export{l as wf_flyout};